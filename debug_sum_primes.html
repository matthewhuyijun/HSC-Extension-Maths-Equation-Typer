<!DOCTYPE html>
<html>
<head>
    <title>Debug Sum over Primes</title>
    <style>
        body {
            font-family: monospace;
            max-width: 900px;
            margin: 20px auto;
            padding: 20px;
        }
        .stage {
            background: #f0f0f0;
            padding: 10px;
            margin: 10px 0;
            border-left: 4px solid #0066cc;
        }
        .error {
            color: red;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>Debug: Sum over Primes</h1>
    <div id="output"></div>

    <script type="module">
        const outputDiv = document.getElementById('output');
        
        function log(stage, content) {
            const div = document.createElement('div');
            div.className = 'stage';
            div.innerHTML = `<strong>${stage}:</strong><br><pre>${content}</pre>`;
            outputDiv.appendChild(div);
        }
        
        try {
            // Import the converter
            const { toWordEquation } = await import('./js/latex-converter.js');
            
            // Test case
            const latex = '\\sum_{p \\in \\mathbb{P}} \\frac{1}{p^s}';
            log('Input LaTeX', latex);
            
            // Convert
            const result = toWordEquation(latex);
            log('Final Output', result);
            
            // What we expect
            log('Expected', '∑_(p∈ℙ)▒(1)/(p^s)');
            
            // Character analysis
            const chars = [];
            for (let i = 0; i < result.length; i++) {
                const c = result[i];
                chars.push(`[${i}] '${c}' U+${c.charCodeAt(0).toString(16).toUpperCase().padStart(4, '0')}`);
            }
            log('Character breakdown', chars.join('\n'));
            
        } catch (error) {
            const div = document.createElement('div');
            div.className = 'error';
            div.textContent = 'ERROR: ' + error.message + '\n' + error.stack;
            outputDiv.appendChild(div);
        }
    </script>
</body>
</html>

